<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Science&Facts</title>
  <meta name="description" content="Explore fascinating science facts and discoveries" />
  <meta name="keywords" content="science, facts, discoveries, education" />
  <link rel="icon" href="https://emoji.gg/assets/emoji/9098_silly_face.png" />

  <!-- GOOGLE FONTS -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700|Montserrat:400,600&display=swap" rel="stylesheet" />

  <!-- ICONS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- SWIPER.JS FOR CAROUSELS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />

  <style>
    /* =====================================================================
       NEW SOCIAL FEATURES
       ===================================================================== */
    /* User profile dropdown */
    .profile-dropdown {
      position: relative;
      display: inline-block;
    }
    
    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      background-color: #f9f9f9;
      min-width: 200px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
      border-radius: 8px;
      overflow: hidden;
    }
    
    .dropdown-content a {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
      transition: background 0.3s;
    }
    
    .dropdown-content a:hover {
      background-color: #3498db;
      color: white;
    }
    
    .profile-dropdown:hover .dropdown-content {
      display: block;
    }
    
    /* Profile edit modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 1001;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
    }
    
    .modal-content {
      background-color: #fefefe;
      margin: 10% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 500px;
      border-radius: 10px;
    }
    
    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }
    
    .close:hover {
      color: black;
    }
    
    /* Friends list */
    .friends-container {
      display: none;
      position: fixed;
      right: 20px;
      top: 80px;
      width: 300px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      padding: 15px;
      z-index: 1000;
    }
    
    .friend-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    
    .friend-item img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
    }
    
    /* Groups section */
    .groups-container {
      display: none;
      position: fixed;
      right: 20px;
      top: 80px;
      width: 300px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      padding: 15px;
      z-index: 1000;
    }
    
    .group-item {
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    
    /* Multiplayer game invites */
    .game-invite {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #2ecc71;
      color: white;
      padding: 15px;
      border-radius: 10px;
      display: none;
      z-index: 1000;
    }
    
    /* Dark mode adjustments */
    body.dark .dropdown-content,
    body.dark .friends-container,
    body.dark .groups-container,
    body.dark .modal-content {
      background-color: #2d2d2d;
      color: #f0f0f0;
    }
    
    body.dark .dropdown-content a {
      color: #f0f0f0;
    }
    
    body.dark .dropdown-content a:hover {
      background-color: #ff6b6b;
    }
    
    /* =====================================================================
       EXISTING STYLES (keep all your previous styles below this point)
       ===================================================================== */
    *,
    *::before,
    *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    /* ... rest of your existing CSS ... */
  </style>
</head>

<body>
  <!-- PRELOADER -->
  <div id="preloader">
    <div class="spinner"></div>
  </div>

  <!-- NAVIGATION -->
  <header>
    <nav class="navbar">
      <div class="logo">Science&Facts</div>
      <ul>
        <li><a href="main.html">Home</a></li>
        <li><a href="test.html">Facts & Discoveries</a></li>
        <li><a href="dictionary.html">Dictionary</a></li>
        <li><a href="Quiz.html">Quizzes</a></li>
        <li><a href="Games.html">Games</a></li>
      </ul>
      
      <!-- User profile with dropdown -->
      <div class="profile-dropdown">
        <img src="https://images.unsplash.com/photo-1633332755192-727a05c4013d?ixlib=rb-1.2.1&auto=format&fit=crop&w=80&h=80&q=80" 
             alt="Profile" class="profile-pic" id="profilePic">
        <div class="dropdown-content">
          <a href="#" id="viewProfile">View Profile</a>
          <a href="#" id="editProfile">Edit Profile</a>
          <a href="#" id="viewFriends">Friends</a>
          <a href="#" id="viewGroups">Groups</a>
          <a href="#" id="logout">Logout</a>
        </div>
      </div>
      
      <i class="fas fa-bars menu-toggle"></i>
      <button class="theme-toggler"><i class="fas fa-moon"></i></button>
    </nav>

    <!-- HERO SLIDER -->
    <div class="hero-slider swiper">
      <div class="swiper-wrapper">
        <!-- Slide 1 -->
        <div class="swiper-slide" style="background-image:url('https://picsum.photos/id/1015/1600/900')">
          <div class="slide-content">
            <h1>Explore the <span class="typed"></span></h1>
            <p>Discover amazing science facts and fascinating discoveries from around the world.</p>
            <button onclick="location.href='test.html'">Explore Facts</button>
          </div>
        </div>
        <!-- Slide 2 -->
        <div class="swiper-slide" style="background-image:url('sean-oulashin-KMn4VEeEPR8-unsplash.jpg')">
          <div class="slide-content">
            <h1>Science is Amazing<span class="typed"></span></h1>
            <p>Learn about the wonders of our universe through interactive content.</p>
            <button onclick="location.href='Quiz.html'">Try Quizzes</button>
          </div>
        </div>
        <!-- Slide 3 -->
        <div class="swiper-slide" style="background-image:url('pexels-therato-1933320.jpg')">
          <div class="slide-content">
            <h1>Practice grammar<span class="typed"></span></h1>
            <p>Dont know the meaning of a word no worries!</p>
            <button onclick="location.href='dictionary.html'">Try Dictionary</button>
          </div>
        </div>
      </div>
      <!-- Slider controls -->
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
    </div>
  </header>

  <!-- Search for friends -->
  <div class="search-container">
    <input type="text" class="search-bar" placeholder="Search for friends..." id="friendSearch">
    <div class="search-results" id="searchResults">
      <!-- Search results will be populated here -->
    </div>
  </div>

  <!-- Friends list panel -->
  <div class="friends-container" id="friendsContainer">
    <h3>Your Friends</h3>
    <div id="friendsList">
      <!-- Friends will be populated here -->
    </div>
  </div>

  <!-- Groups panel -->
  <div class="groups-container" id="groupsContainer">
    <h3>Your Groups</h3>
    <button id="createGroup">Create New Group</button>
    <div id="groupsList">
      <!-- Groups will be populated here -->
    </div>
  </div>

  <!-- Game invite notification -->
  <div class="game-invite" id="gameInvite">
    <p id="inviteMessage">Alex invited you to play Science Quiz!</p>
    <button id="acceptInvite">Accept</button>
    <button id="declineInvite">Decline</button>
  </div>

  <!-- Profile edit modal -->
  <div id="profileModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Edit Profile</h2>
      <form id="profileForm">
        <div>
          <label for="profileName">Name:</label>
          <input type="text" id="profileName" required>
        </div>
        <div>
          <label for="profileBio">Bio:</label>
          <textarea id="profileBio" rows="4"></textarea>
        </div>
        <div>
          <label for="profilePicUpload">Profile Picture:</label>
          <input type="file" id="profilePicUpload" accept="image/*">
        </div>
        <button type="submit">Save Changes</button>
      </form>
    </div>
  </div>

  <!-- Keep all your existing sections exactly the same -->
  <section id="facts">
    <!-- Your existing facts section -->
  </section>
  
  <section id="site-features">
    <!-- Your existing features section -->
  </section>

  <!-- Add multiplayer features to games and quizzes -->
  <section id="multiplayer">
    <h2 class="section-title">Multiplayer Features</h2>
    <div class="container grid grid-3">
      <div class="feature-card">
        <i class="fas fa-users"></i>
        <h3>Challenge Friends</h3>
        <p>Invite friends to compete in real-time quizzes</p>
      </div>
      <div class="feature-card">
        <i class="fas fa-trophy"></i>
        <h3>Leaderboards</h3>
        <p>See how you rank against your friends</p>
      </div>
      <div class="feature-card">
        <i class="fas fa-comments"></i>
        <h3>Group Chats</h3>
        <p>Discuss science topics with your study groups</p>
      </div>
    </div>
  </section>

  <!-- Your other existing sections -->

  <!-- ===================================================================
       JAVASCRIPT INCLUDES & INITIALIZATION
       =================================================================== -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
  <script>
    // User data management
    let currentUser = JSON.parse(localStorage.getItem('currentUser')) || {
      id: Date.now().toString(),
      name: 'New User',
      username: 'user' + Math.floor(Math.random() * 1000),
      bio: '',
      profilePic: 'https://images.unsplash.com/photo-1633332755192-727a05c4013d?ixlib=rb-1.2.1&auto=format&fit=crop&w=80&h=80&q=80',
      friends: [],
      groups: []
    };

    // Mock database
    let usersDB = JSON.parse(localStorage.getItem('usersDB')) || [currentUser];
    let groupsDB = JSON.parse(localStorage.getItem('groupsDB')) || [];

    // Initialize the app
    function initApp() {
      // Load user data
      document.getElementById('profileName').value = currentUser.name;
      document.getElementById('profileBio').value = currentUser.bio;
      document.getElementById('profilePic').src = currentUser.profilePic;
      
      // Load friends
      renderFriends();
      
      // Load groups
      renderGroups();
    }

    // Profile edit functionality
    document.getElementById('editProfile').addEventListener('click', function() {
      document.getElementById('profileModal').style.display = 'block';
    });

    document.querySelector('.close').addEventListener('click', function() {
      document.getElementById('profileModal').style.display = 'none';
    });

    document.getElementById('profileForm').addEventListener('submit', function(e) {
      e.preventDefault();
      currentUser.name = document.getElementById('profileName').value;
      currentUser.bio = document.getElementById('profileBio').value;
      
      // Handle profile picture upload
      const fileInput = document.getElementById('profilePicUpload');
      if (fileInput.files.length > 0) {
        const file = fileInput.files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
          currentUser.profilePic = e.target.result;
          document.getElementById('profilePic').src = currentUser.profilePic;
          saveUserData();
        };
        reader.readAsDataURL(file);
      }
      
      saveUserData();
      document.getElementById('profileModal').style.display = 'none';
    });

    // Friends functionality
    document.getElementById('viewFriends').addEventListener('click', function(e) {
      e.preventDefault();
      document.getElementById('friendsContainer').style.display = 
        document.getElementById('friendsContainer').style.display === 'block' ? 'none' : 'block';
      document.getElementById('groupsContainer').style.display = 'none';
    });

    function renderFriends() {
      const friendsList = document.getElementById('friendsList');
      friendsList.innerHTML = '';
      
      if (currentUser.friends.length === 0) {
        friendsList.innerHTML = '<p>You have no friends yet. Search for users to add friends!</p>';
        return;
      }
      
      currentUser.friends.forEach(friendId => {
        const friend = usersDB.find(u => u.id === friendId);
        if (friend) {
          const friendItem = document.createElement('div');
          friendItem.className = 'friend-item';
          friendItem.innerHTML = `
            <img src="${friend.profilePic}" alt="${friend.name}">
            <div>
              <strong>${friend.name}</strong>
              <div>@${friend.username}</div>
            </div>
            <button class="invite-btn" data-id="${friend.id}">Invite to Game</button>
          `;
          friendsList.appendChild(friendItem);
        }
      });
      
      // Add event listeners to invite buttons
      document.querySelectorAll('.invite-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const friendId = this.getAttribute('data-id');
          inviteFriendToGame(friendId);
        });
      });
    }

    // Groups functionality
    document.getElementById('viewGroups').addEventListener('click', function(e) {
      e.preventDefault();
      document.getElementById('groupsContainer').style.display = 
        document.getElementById('groupsContainer').style.display === 'block' ? 'none' : 'block';
      document.getElementById('friendsContainer').style.display = 'none';
    });

    document.getElementById('createGroup').addEventListener('click', function() {
      const groupName = prompt('Enter group name:');
      if (groupName) {
        const newGroup = {
          id: Date.now().toString(),
          name: groupName,
          members: [currentUser.id],
          admin: currentUser.id
        };
        groupsDB.push(newGroup);
        currentUser.groups.push(newGroup.id);
        saveUserData();
        localStorage.setItem('groupsDB', JSON.stringify(groupsDB));
        renderGroups();
      }
    });

    function renderGroups() {
      const groupsList = document.getElementById('groupsList');
      groupsList.innerHTML = '';
      
      if (currentUser.groups.length === 0) {
        groupsList.innerHTML = '<p>You have no groups yet. Create one!</p>';
        return;
      }
      
      currentUser.groups.forEach(groupId => {
        const group = groupsDB.find(g => g.id === groupId);
        if (group) {
          const groupItem = document.createElement('div');
          groupItem.className = 'group-item';
          groupItem.innerHTML = `
            <h4>${group.name}</h4>
            <p>Members: ${group.members.length}</p>
            <button class="group-chat-btn" data-id="${group.id}">Chat</button>
            ${group.admin === currentUser.id ? 
              '<button class="invite-group-btn" data-id="${group.id}">Invite Members</button>' : ''}
          `;
          groupsList.appendChild(groupItem);
        }
      });
    }

    // Friend search functionality
    document.getElementById('friendSearch').addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      const resultsContainer = document.getElementById('searchResults');
      
      if (searchTerm.length < 2) {
        resultsContainer.style.display = 'none';
        return;
      }
      
      const filteredUsers = usersDB.filter(user => 
        (user.name.toLowerCase().includes(searchTerm) || 
         user.username.toLowerCase().includes(searchTerm)) &&
        user.id !== currentUser.id &&
        !currentUser.friends.includes(user.id)
      ).slice(0, 5);
      
      if (filteredUsers.length > 0) {
        resultsContainer.innerHTML = filteredUsers.map(user => `
          <div class="search-result-item">
            <img src="${user.profilePic}" alt="${user.name}">
            <div>
              <strong>${user.name}</strong>
              <div>@${user.username}</div>
            </div>
            <button class="add-friend-btn" data-id="${user.id}">Add Friend</button>
          </div>
        `).join('');
        resultsContainer.style.display = 'block';
      } else {
        resultsContainer.innerHTML = '<div class="search-result-item">No users found</div>';
        resultsContainer.style.display = 'block';
      }
    });
    
    // Add friend functionality
    document.getElementById('searchResults').addEventListener('click', function(e) {
      if (e.target.classList.contains('add-friend-btn')) {
        const userId = e.target.getAttribute('data-id');
        const user = usersDB.find(u => u.id === userId);
        
        if (user && !currentUser.friends.includes(userId)) {
          currentUser.friends.push(userId);
          saveUserData();
          alert(`Friend request sent to ${user.name}!`);
          document.getElementById('searchResults').style.display = 'none';
          document.getElementById('friendSearch').value = '';
          renderFriends();
        }
      }
    });
    
    // Game invite functionality
    function inviteFriendToGame(friendId) {
      const friend = usersDB.find(u => u.id === friendId);
      if (friend) {
        alert(`Invitation sent to ${friend.name} to play a game!`);
        // In a real app, you would send this via WebSocket or similar
      }
    }
    
    // Simulate receiving a game invite
    function simulateGameInvite() {
      if (usersDB.length > 1) {
        const randomUser = usersDB.find(u => u.id !== currentUser.id);
        document.getElementById('inviteMessage').textContent = 
          `${randomUser.name} invited you to play Science Quiz!`;
        document.getElementById('gameInvite').style.display = 'block';
      }
    }
    
    document.getElementById('acceptInvite').addEventListener('click', function() {
      alert('Starting game with friend!');
      document.getElementById('gameInvite').style.display = 'none';
      // Redirect to multiplayer game
      window.location.href = 'Quiz.html?multiplayer=true';
    });
    
    document.getElementById('declineInvite').addEventListener('click', function() {
      document.getElementById('gameInvite').style.display = 'none';
    });
    
    // Save user data to localStorage
    function saveUserData() {
      // Update user in DB
      const userIndex = usersDB.findIndex(u => u.id === currentUser.id);
      if (userIndex !== -1) {
        usersDB[userIndex] = currentUser;
      } else {
        usersDB.push(currentUser);
      }
      
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      localStorage.setItem('usersDB', JSON.stringify(usersDB));
    }
    
    // Logout functionality
    document.getElementById('logout').addEventListener('click', function(e) {
      e.preventDefault();
      localStorage.removeItem('currentUser');
      window.location.href = 'index.html';
    });
    
    // Initialize the app when loaded
    window.addEventListener('load', function() {
      initApp();
      
      // Simulate a game invite after 10 seconds (for demo)
      setTimeout(simulateGameInvite, 10000);
      
      // Your existing initialization code
      document.getElementById('preloader').style.display = 'none';
      
      // Mobile nav toggle
      const menuToggle = document.querySelector('.menu-toggle');
      const navUL = document.querySelector('.navbar ul');
      menuToggle.addEventListener('click', () => navUL.classList.toggle('show'));
      
      // Theme toggler
      const themeBtn = document.querySelector('.theme-toggler');
      themeBtn.addEventListener('click', () => {
        document.body.classList.toggle('dark');
        themeBtn.innerHTML = document.body.classList.contains('dark')
          ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
      });
      
      // Back to top
      const backBtn = document.getElementById('backToTop');
      window.addEventListener('scroll', () => {
        backBtn.style.display = window.scrollY > 500 ? 'block' : 'none';
      });
      backBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
      
      // Swiper hero
      new Swiper('.hero-slider', {
        loop: true,
        speed: 1000,
        autoplay: { delay: 5000 },
        navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
      });
      
      // Typed.js effect
      new Typed('.typed', {
        strings: ['Wonderful.', 'Amazing.', 'Fascinating.'],
        typeSpeed: 80,
        backSpeed: 50,
        loop: true
      });
      
      // FAQ accordion
      const faqs = document.querySelectorAll('.faq-item');
      faqs.forEach(item => {
        item.querySelector('.faq-question').addEventListener('click', () => {
          item.classList.toggle('open');
          item.querySelector('.faq-question').classList.toggle('active');
        });
      });
    });
  </script>
</body>
</html>
